# Requirements Document

## Introduction

Telegram бот для скачивания видео с YouTube Shorts и TikTok. Бот работает через inline-режим, позволяя пользователям вставлять ссылки в любых чатах через упоминание @savxbot, после чего видео автоматически загружается и становится доступным для отправки.

## Glossary

- **Bot**: Telegram бот-приложение
- **Inline_Mode**: Режим работы Telegram бота, когда пользователь вызывает бота через @ в любом чате
- **Video_Downloader**: Компонент для загрузки видео с платформ
- **YouTube_Shorts**: Короткие вертикальные видео на платформе YouTube
- **TikTok**: Платформа для коротких видео
- **User**: Пользователь Telegram, взаимодействующий с ботом

## Requirements

### Requirement 1: Скачивание видео с YouTube Shorts

**User Story:** Как пользователь, я хочу скачивать видео с YouTube Shorts через бота, чтобы делиться ими в Telegram чатах.

#### Acceptance Criteria

1. WHEN пользователь отправляет ссылку на YouTube Shorts, THE Bot SHALL распознать ссылку как валидную YouTube Shorts ссылку
2. WHEN валидная ссылка YouTube Shorts получена, THE Video_Downloader SHALL загрузить видео используя yt-dlp
3. WHEN видео загружено, THE Bot SHALL сохранить видео во временное хранилище
4. WHEN загрузка завершена, THE Bot SHALL отправить видео пользователю

### Requirement 2: Скачивание видео с TikTok

**User Story:** Как пользователь, я хочу скачивать видео с TikTok через бота, чтобы делиться ими в Telegram чатах.

#### Acceptance Criteria

1. WHEN пользователь отправляет ссылку на TikTok видео, THE Bot SHALL распознать ссылку как валидную TikTok ссылку
2. WHEN валидная ссылка TikTok получена, THE Video_Downloader SHALL загрузить видео используя yt-dlp
3. WHEN видео загружено, THE Bot SHALL сохранить видео во временное хранилище
4. WHEN загрузка завершена, THE Bot SHALL отправить видео пользователю

### Requirement 3: Inline-режим работы бота

**User Story:** Как пользователь, я хочу использовать бота через inline-режим (@savxbot) в любых чатах, чтобы быстро делиться видео без переключения в личный чат с ботом.

#### Acceptance Criteria

1. WHEN пользователь вводит @savxbot в любом чате, THE Bot SHALL активировать inline-режим
2. WHEN пользователь вставляет ссылку после @savxbot, THE Bot SHALL начать обработку ссылки
3. WHEN видео загружается, THE Bot SHALL показывать статус загрузки в inline-результатах
4. WHEN видео готово, THE Bot SHALL отобразить превью видео в inline-результатах для отправки
5. WHEN пользователь выбирает готовое видео из inline-результатов, THE Bot SHALL отправить видео в текущий чат

### Requirement 4: Автоматическое обновление статуса загрузки

**User Story:** Как пользователь, я хочу видеть актуальный статус загрузки видео, чтобы понимать, когда оно будет готово к отправке.

#### Acceptance Criteria

1. WHEN видео начинает загружаться, THE Bot SHALL отобразить статус "Загрузка..."
2. WHILE видео загружается, THE Bot SHALL обновлять статус в inline-результатах
3. WHEN видео загружено, THE Bot SHALL обновить статус на "Готово к отправке"
4. IF загрузка не удалась, THEN THE Bot SHALL отобразить сообщение об ошибке

### Requirement 5: Валидация ссылок

**User Story:** Как пользователь, я хочу получать понятные сообщения об ошибках, чтобы понимать, почему видео не загружается.

#### Acceptance Criteria

1. WHEN пользователь отправляет невалидную ссылку, THE Bot SHALL отклонить запрос с понятным сообщением
2. WHEN ссылка не является YouTube Shorts или TikTok, THE Bot SHALL сообщить о неподдерживаемой платформе
3. WHEN видео недоступно для загрузки, THE Bot SHALL сообщить о недоступности контента

### Requirement 6: Управление временными файлами

**User Story:** Как системный администратор, я хочу, чтобы бот автоматически удалял временные файлы, чтобы не переполнять дисковое пространство.

#### Acceptance Criteria

1. WHEN видео загружено и отправлено пользователю, THE Bot SHALL удалить временный файл
2. WHEN видео не было отправлено в течение 1 часа, THE Bot SHALL удалить временный файл
3. THE Bot SHALL хранить временные файлы в выделенной директории

### Requirement 7: Обработка ошибок загрузки

**User Story:** Как пользователь, я хочу получать информативные сообщения об ошибках, чтобы понимать, что пошло не так.

#### Acceptance Criteria

1. IF загрузка видео не удалась, THEN THE Bot SHALL отправить сообщение с описанием ошибки
2. IF yt-dlp недоступен, THEN THE Bot SHALL сообщить о технической проблеме
3. IF видео слишком большое для Telegram, THEN THE Bot SHALL сообщить о превышении лимита размера

### Requirement 8: Конфигурация бота

**User Story:** Как разработчик, я хочу легко настраивать параметры бота, чтобы адаптировать его под разные окружения.

#### Acceptance Criteria

1. THE Bot SHALL читать токен Telegram API из переменных окружения
2. THE Bot SHALL читать настройки yt-dlp из конфигурационного файла
3. THE Bot SHALL поддерживать настройку максимального размера загружаемого видео
